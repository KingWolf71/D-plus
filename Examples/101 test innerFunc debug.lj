// Debug test for innerFunc issue
#pragma appname "InnerFunc-Debug"
#pragma console on
#pragma consolesize "680x740"
#pragma consoleposition "30,50"
#pragma ListASM on
#pragma PasteToClipboard on

print("=== INNERFUNCTION DEBUG TEST ===");
print("");

func innerFunc(n.i) {
    print("  innerFunc called with n = ", n);

    list temp.i;
    print("  LIST_NEW done");

    listAdd(temp, n);
    print("  Added n = ", n);

    listAdd(temp, n * 2);
    print("  Added n*2 = ", n * 2);

    listAdd(temp, n * 3);
    print("  Added n*3 = ", n * 3);

    sz.i = listSize(temp);
    print("  List size = ", sz);

    sum.i = 0;
    print("  Initial sum = ", sum);

    listReset(temp);
    print("  After listReset");

    count.i = 0;
    while listNext(temp) {
        count = count + 1;
        val.i = listGet(temp);
        print("    Iteration ", count, ": listGet = ", val);
        sum = sum + val;
        print("    Running sum = ", sum);
    }

    print("  Total iterations: ", count);
    print("  Final sum = ", sum);
    print("  Returning sum");

    return sum;
}

print("Calling innerFunc(10)...");
r1.i = innerFunc(10);
print("r1 = ", r1, " (should be 60)");
print("");

print("Calling innerFunc(5)...");
r2.i = innerFunc(5);
print("r2 = ", r2, " (should be 30)");
print("");

print("=== TEST COMPLETE ===");
